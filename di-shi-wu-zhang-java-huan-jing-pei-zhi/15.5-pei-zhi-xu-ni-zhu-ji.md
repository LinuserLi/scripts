# 15.5：配置虚拟主机

**绑定IP，监听单个IP**

默认情况下，服务器上的tomcat 会监控服务器上的所有服务器。这就导致了我使用服务器上所有IP + 端口都可以访问到该tomcat 项目。为避免出现这样的情况。我们可以指定tomcat 绑定单个IP，即：tomcat 只监听某个IP 的8080 端口。

1、编辑 tomcat 主配置文件 /usr/local/tomcat/conf/server.xml ，找到配置文件文件中 <Connector port="8080" protocol="HTTP/1.1" connectionTimeout="20000" redirectPort="8443" /> 段，增加 address= 参数：

```bash
    <Connector port="8080" protocol="HTTP/1.1"
               address="192.168.137.101"
               connectionTimeout="20000"
               redirectPort="8443" />
```

修改好，保存退出。重启下tomcat:

```bash
[root@centos ~]# systemctl restart tomcat
```

2、在服务器上查看监听的IP及端口：

```bash
[root@centos ~]# ss -lntp |egrep java
LISTEN     0      100     ::ffff:192.168.137.101:8080                    :::*                   users:(("java",pid=1942,fd=49))
LISTEN     0      1         ::ffff:127.0.0.1:8005                    :::*                   users:(("java",pid=1942,fd=70))
LISTEN     0      100         :::8009                    :::*                   users:(("java",pid=1942,fd=54))
```

3、测试访问，使用IP 192.168.137.101:8080 访问tomcat 项目，可以正常访问。

![](../.gitbook/assets/20180422002.jpg)

但是使用该服务器上的其它IP 地址访问，则无法访问：

![](../.gitbook/assets/20180422001.jpg)

**绑定域名**

tomcat 默认绑定的域名是localhost ，即使用该服务器上的IP 就可以访问tomcat 项目，但是有时候我们需要绑定域名，以便区分多个项目（其实这种情况基本不会出现，这里只是教大家怎么配置域名）.注：如果该配置文件中，有绑定IP 地址的话，则必须使用该IP地址做解析，然后加绑定域名方可访问：

1、编辑tomcat 主配置文件 /usr/local/tomcat/conf/server.xml ，找到配置文件文件中 <Host name="localhost"  appBase="webapps" unpackWARs="true" autoDeploy="true"> 段，将 localhost 修改成要绑定的域名：
     
```bash
     <Host name="host1.tomcat.org"  appBase="webapps"
            unpackWARs="true" autoDeploy="true">
```

2、重启 tocmat"

```bash
[root@centos ~]# systemctl restart tomcat
```

3、做好本地解析后（注，绑定的IP 和域名）。在浏览器中使用域名，可以正常访问：



使用绑定的IP访问，无法访问：

